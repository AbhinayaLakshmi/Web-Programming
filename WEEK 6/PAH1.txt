PRACTICE AT HOME 1

// /controllers/productController.js

const Product=require('../models/productModel');
exports.createProduct=async(req,res,next) => {
    try{
        const {name,price,category,inStock}=req.body;
        const product=new Product({name,price,category,inStock});
        const savedProduct=await product.save();
        res.status(201).json(savedProduct);
    }catch(err) {
        next(err);
    }
};
exports.getAllProducts=async(req,res,next) => {
    try{
        const products=await Product.find();
        res.status(200).json(products);
    }catch(err){
        next(err);
    }
};

// /middlewares/errorHandler.js

const errorHandler=(err,req,res,next) => {
    console.error(err.stack);
    const statusCode=res.statusCode !== 200 ? res.statusCode : 500;
    res.status(statusCode).json({
        error:{
            message:err.message,
            stack:process.env.NODE_ENV==='production'? 'Stack trace hidden' : err.stack
        }
    });
};
module.exports=errorHandler;

// /models/productModel.js

const mongoose=require('mongoose');
const productSchema=new mongoose.Schema({
    name:{type:String, required:true},
    price:{type:Number, required:true},
    category:{type:String, required:true},
    inStock:{type:Boolean, default:true}
});
module.exports=mongoose.model('Product',productSchema);

// /routers/productRouter.js

const express=require('express');
const router=express.Router();
const ProductController=require('../controllers/productController');
router.post('/products',ProductController.createProduct);
router.get('/products',ProductController.getAllProducts);
module.exports=router;

// index.js

const express=require('express');
const mongoose=require('mongoose');
const productRoutes=require('./routers/productRoutes');
const errorHandler=require('./middlewares/errorHandler');
const app=express();
const PORT=8080;
app.use(express.json());
mongoose.connect('mongobd://127.0.0.1:27017/productsDB', {
    useNewUrlParser:true,
    useUnifiedTopology:true
})
.then(() => console.log('Connected to MongoDB'))
.catch((err) => console.error('MongoDB connection failed:',err));
app.use('/products',productRoutes);
app.use(errorHandler);
app.listen(PORT, () => {
    console.log(`Server is running on port ${PORT}`);
});

